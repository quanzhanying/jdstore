<h1>
    All Order List
</h1>
<table class="table table-boldered">
    <thead>
        <tr>
            <td>订单编号</td>
            <td>总价(元)</td>
            <td>付款人</td>
            <td>收件人</td>
            <td>订单时间</td>
            <td>订单状态</td>
            <td>状态控制</td>
        </tr>
    </thead>
            <tbody>
                <% @orders.each do |order| %>
                <tr>
                    <td>
                        <%= link_to(truncate(order.token, length: 8), order_path(order.token)) %>
                    </td>

                    <td>
                        <%= order.total%>
                    </td>

                    <td>
                        <%= order.billing_name %>
                    </td>

                    <td>
                        <%= order.shipping_name%>
                    </td>

                    <td>
                        <%= order.created_at %>
                    </td>

                    <td>
                        <%= order.aasm_state %>
                    </td>

                    <td>
                    <%  case order.aasm_state %>
                    <%  when "order_placed" %>
                    <%= link_to("取消订单", cancel_admin_order_path(order.token), :method => :post, :data => { :confirm => "取消订单?" }) %>
                    <%  when "paid" %>
                    <%= link_to("出货", ship_admin_order_path(order.token), :method => :post, :data => { :confirm => "发货吗?" }) %>
                    |
                    <%= link_to("取消订单", cancel_admin_order_path(order.token), :method => :post, :data => { :confirm => "取消订单?" }) %>
                    <%  when "shipping" %>
                    <%= link_to("到货", deliver_admin_order_path(order.token), :method => :post) %>
                    <%  when "shipped" %>
                    <%= link_to("退货", return_admin_order_path(order.token), :method => :post, :data => { :confirm => "有问题不要了。" }) %>
                    <%  when "good_returned" %>
                    <p>
                      货都退了
                    </p>
                    <%  when "order_cancelled" %>
                    <p>
                      什么也不做
                    </p>
                    <%  else %>
                    <p>
                      异常
                    </p>
                    <%  end %>

                    </td>
                </tr>
                <% end %>
              </tbody>
</table>
